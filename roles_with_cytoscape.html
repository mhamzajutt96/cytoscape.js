<!DOCTYPE html>

<html lang="en">

  <head>
    <meta charset="UTF-8">
    <title>Snowflake security roles visualization</title>
    <script src="https://unpkg.com/cytoscape/dist/cytoscape.min.js"></script>
    <script src="https://unpkg.com/dagre@0.7.4/dist/dagre.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/cytoscape-dagre@2.1.0/cytoscape-dagre.min.js"></script>
  </head>

  <body>
    <style>
      body {
        font: 14px helvetica neue, helvetica, arial, sans-serif;
      }
      #cy {
        height: 100%;
        width: 100%;
        position: absolute;
        left: 0;
        top: 0;
        float: left;
      }
    </style>

    <div id="cy"></div>
  </body>

  <script>
    var cy = (window.cy = cytoscape({
      container: document.getElementById("cy"),

      style: [{
        selector: "node",
        css: {
          content: "data(id)",
          "text-valign": "center",
          "text-halign": "center",
          height: "60px",
          width: "60px",
          "border-color": "black",
          "border-opacity": "1",
          "border-width": "10px"
        }
      },
        {
          selector: "edge",
          css: {
            "target-arrow-shape": "triangle"
          }
        }
      ],

      elements: {
        nodes: [{
          data: {
            id: "n0"
          }
        },
          {
            data: {
              id: "n1"
            }
          },
          {
            data: {
              id: "n2"
            }
          },
          {
            data: {
              id: "n3"
            }
          },
          {
            data: {
              id: "n4"
            }
          },
          {
            data: {
              id: "n5"
            }
          },
          {
            data: {
              id: "n6"
            }
          },
          {
            data: {
              id: "n7"
            }
          },
          {
            data: {
              id: "n8"
            }
          },
          {
            data: {
              id: "n9"
            }
          },
          {
            data: {
              id: "n10"
            }
          },
          {
            data: {
              id: "n11"
            }
          },
          {
            data: {
              id: "n12"
            }
          },
          {
            data: {
              id: "n13"
            }
          },
          {
            data: {
              id: "n14"
            }
          },
          {
            data: {
              id: "n15"
            }
          },
          {
            data: {
              id: "n16"
            }
          }
        ],
        edges: [{
          data: {
            source: "n0",
            target: "n1"
          }
        },
          {
            data: {
              source: "n1",
              target: "n2"
            }
          },
          {
            data: {
              source: "n1",
              target: "n3"
            }
          },
          {
            data: {
              source: "n4",
              target: "n5"
            }
          },
          {
            data: {
              source: "n4",
              target: "n6"
            }
          },
          {
            data: {
              source: "n6",
              target: "n7"
            }
          },
          {
            data: {
              source: "n6",
              target: "n8"
            }
          },
          {
            data: {
              source: "n8",
              target: "n9"
            }
          },
          {
            data: {
              source: "n8",
              target: "n10"
            }
          },
          {
            data: {
              source: "n11",
              target: "n12"
            }
          },
          {
            data: {
              source: "n12",
              target: "n13"
            }
          },
          {
            data: {
              source: "n13",
              target: "n14"
            }
          },
          {
            data: {
              source: "n13",
              target: "n15"
            }
          }
        ]
      },

      layout: {
        name: "dagre",
        padding: 5
      }
    }));


    cy.unbind('click')
    cy.bind('click', 'node', function(event) {
      // .union() takes two collections and adds both together without duplicates
      var connected = event.target
      connected = connected.union(event.target.predecessors())
      connected = connected.union(connected.successors())
      // in one line:
      // event.target.union(event.target.predecessors().union(event.target.successors()))

      // .not() filters out whatever is not specified in connected, e.g. every other node/edge not present in connected
      var notConnected = cy.elements().not(connected)

      // if you want, you can later add the saved elements again
      var saved = cy.remove(notConnected)
    });
  </script>

</html>
